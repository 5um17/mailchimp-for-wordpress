!function(a){"use strict";function b(){"boolean"==typeof this.checked&&(this.checked=!1),alert(mc4wp.strings.proOnlyNotice),event.stopPropagation()}function c(){var b=a(document.getElementById("mc4wp-send-welcome"));0==a(this).val()?b.removeClass("hidden").find(":input").removeAttr("disabled"):b.addClass("hidden").find(":input").attr("disabled","disabled").prop("checked",!1)}function d(){var b=a(document.getElementById("woocommerce-settings"));b.toggle(a(this).prop("checked"))}function e(){var b=j.filter(":checked").length>0;a(".mc4wp-notice.no-lists-selected").toggle(!b),a(document.getElementById("mc4wp-fw-fields")).toggle(b),a(document.getElementById("mc4wp-fw-mailchimp-fields")).toggle(b)}function f(b){var c=b.keyCode||b.which;if(9===c){b.preventDefault();var d=this.selectionStart,e=this.selectionEnd;a(this).val(a(this).val().substring(0,d)+"	"+a(this).val().substring(e)),this.selectionStart=this.selectionEnd=d+1}}function g(){"undefined"!=typeof QTags&&(QTags.addButton("mc4wp_paragraph","<p>","<p>","</p>","paragraph","Paragraph tag",1),QTags.addButton("mc4wp_label","label","<label>","</label>","label","Label tag",2),QTags.addButton("mc4wp_response","form response","{response}","","response","Shows the form response"),QTags.addButton("mc4wp_subscriber_count","# of subscribers","{subscriber_count}","","subscribers","Shows number of subscribers of selected list(s)"),window.mc4wp.hasCaptchaPlugin===!0&&QTags.addButton("mc4wp_captcha","CAPTCHA","{captcha}","","captcha","Display a CAPTCHA field"))}function h(){var b=j.filter(":checked"),c=[];b.each(function(){for(var b=a(this).val(),d=mc4wp.mailchimpLists[b],e=0;e<d.merge_vars.length;e++)d.merge_vars[e].req&&c.push(d.merge_vars[e])});for(var d={},e=0;e<c.length;e++){var f='name="'+c[e].tag.toLowerCase();-1==k.val().toLowerCase().indexOf(f)&&(d[c[e].tag]=c[e])}if(a.isEmptyObject(d))return l.hide(),!1;m.html("");for(var g in d){var h=d[g],i=a("<li />");i.html(h.name+" (<code>"+h.tag+"</code>)"),i.appendTo(m)}return l.show(),!0}var i=a(document.getElementById("mc4wp-admin")),j=a(document.getElementById("mc4wp-lists")).find(":input"),k=a(document.getElementById("mc4wpformmarkup")),l=a(document.getElementById("missing-fields-notice")),m=a(document.getElementById("missing-fields-list"));i.find(".pro-feature, .pro-feature label, .pro-feature :radio").click(b),i.find('input[name$="[double_optin]"]').change(c),i.find('input[name$="[show_at_woocommerce_checkout]"]').change(d()),j.change(e),a(document).delegate("#mc4wpformmarkup","keydown",f),k.change(h),g(),h(),function(){function b(){p.find("option").not(".default").remove(),o.filter(":checked").each(function(){for(var b=a(this).val(),c=mc4wp.mailchimpLists[b],d=0,e=c.merge_vars.length;e>d;d++){var f=c.merge_vars[d];if(0===q.find("option[value='"+f.tag+"']").length){var g=f.name.length>25?f.name.substring(0,25)+"..":f.name;f.req&&(g+="*");var h=a("<option />").text(g).val(f.tag).data("list-field",f);d>3&&h.text(B.proOnly+" "+g).attr("disabled","disabled").data("field",null),q.append(h)}}for(var d=0,i=c.interest_groupings.length;i>d;d++){var j=c.interest_groupings[d];if(0===r.find("option[value='"+j.id+"']").length){var g=j.name.length>25?j.name.substring(0,25)+"..":j.name,h=a("<option />").text(g).val(j.id).data("list-grouping",j);d>=1&&h.text(B.proOnly+" "+g).attr("disabled","disabled").data("list-grouping",null),r.append(h)}}})}function c(){d();var b=a(this).find(":selected");switch(b.val()){case"submit":m="submit",u.text(B.buttonText),t.val(B.subscribe),s.find("p.row").filter(".value, .wrap-p").show();break;case"lists":m="lists",s.find(".wrap-p").show();break;default:var c=b.data("list-field");if(c)return h(c);var c=b.data("list-grouping");if(c)return f(c)}j()}function d(){s.find(".row :input").each(function(){a(this).is(":checkbox")?this.checked=!0:this.value=""}),s.find("p.row").hide(),v.find(":input").remove(),s.show(),m="text",n="",u.html(B.initialValue+" <small>"+B.optional+"</small>")}function e(b){for(var c=0,d=b.length;d>c;c++)a("<input />").attr("type","text").addClass("widefat").data("value",b[c].name).attr("placeholder",B.labelFor+' "'+b[c].name+'" '+B.orLeaveEmpty).attr("value",b[c].name).appendTo(v)}function f(a){switch(s.find("p.row").filter(".values, .label, .wrap-p").show(),w.val(a.name+":"),n="GROUPINGS["+a.id+"]",e(a.groups),a.form_field){case"radio":m="radio";break;case"hidden":s.find("p.row").filter(".values, .label, .wrap-p").hide(),s.find("p.row.value").show();for(var b=0,c=a.groups.length;c>b;b++)t.val(t.val()+a.groups[b].name+",");m="hidden";break;case"dropdown":m="select";break;default:m="checkbox",n+="[]"}j()}function g(){var b="";return o.each(function(){var c=a(this).val(),d=a(this).parent("label").text(),e="";a(this).is(":checked")&&(e+="checked "),b+="<label>\n",b+='	<input type="checkbox" name="_mc4wp_lists[]" value="'+c+'" '+e+" /> "+d+"\n",b+="</label>\n"}),b}function h(b){var c={"default":["label","value","placeholder","required","wrap-p"],select:["label","required","wrap-p","values"],radio:["label","required","wrap-p","values"],date:["label","required","wrap-p","value"]},d={text:"text",email:"email",phone:"tel",address:"text",number:"number",dropdown:"select",date:"date",birthday:"date",radio:"radio",checkbox:"checkbox"};if(m="undefined"!=typeof d[b.field_type]?d[b.field_type]:"text","undefined"!=typeof c[m])var e=c[m];else var e=c["default"];for(var f=0;f<e.length;f++)s.find("p.row."+e[f]).show();if(m=m,n=b.tag,x.val("Your "+b.name.toLowerCase()),w.val(b.name+":"),y.attr("checked",b.req),v.is(":visible")&&b.choices)for(var f=0;f<b.choices.length;f++)a("<input />").attr("type","text").addClass("widefat").data("value",b.choices[f]).attr("placeholder",B.labelFor+' "'+b.choices[f]+'" '+B.orLeaveEmpty).attr("value",b.choices[f]).appendTo(v);j()}function i(a){a=html_beautify(a),A.val(a)}function j(){var b,c=a("<div></div>");switch(m){case"lists":var d=g();return l()&&(d="<p>"+d+"</p>"),i(d);case"select":b=a("<select />"),v.find(":input").each(function(){a(this).val().length>0&&a("<option />").val(a(this).data("value")).text(a(this).val()).appendTo(b)});break;case"radio":case"checkbox":v.find(":input").each(function(){a(this).val().length>0&&(b=a("<input />").attr("type",m).attr("name",n).val(a(this).data("value")),y.is(":visible:checked")&&b.attr("required",!0),c.append(b),b.wrap("<label />"),a("<span />").text(a(this).val()+" ").insertAfter(b))});break;case"textarea":b=a("<textarea />");break;default:b=a("<input />").attr("type",m)}"radio"!==m&&"checkbox"!==m&&(n.length>0&&b.attr("name",n),t.is(":visible")&&t.val().length>0&&("textarea"===m?b.text(t.val()):b.attr("value",t.val())),x.is(":visible")&&x.val().length>0&&b.attr("placeholder",x.val()),y.is(":visible:checked")&&b.attr("required",!0),c.append(b)),w.is(":visible")&&w.val().length>0&&a("<label />").text(w.val()).prependTo(c),l()&&c.wrapInner(a("<p />")),i(c.html())}function k(){var a=!1;"undefined"!=typeof wpActiveEditor&&"undefined"!=typeof QTags&&QTags.insertContent&&(a=QTags.insertContent(A.val())),a||C.val(C.val()+"\n"+A.val()),C.change()}function l(){return z.is(":visible:checked")?!0:!1}var m,n,o=a("#mc4wp-lists :input"),p=a("#mc4wp-fw-mailchimp-fields"),q=p.find(".merge-fields"),r=p.find(".groupings"),s=a("#mc4wp-fw-fields"),t=a("#mc4wp-fw-value"),u=a("#mc4wp-fw-value-label"),v=a("#mc4wp-fw-values"),w=a("#mc4wp-fw-label"),x=a("#mc4wp-fw-placeholder"),y=a("#mc4wp-fw-required"),z=a("#mc4wp-fw-wrap-p"),A=a("#mc4wp-fw-preview"),B=mc4wp.strings.fieldWizard,C=a(document.getElementById("mc4wpformmarkup"));o.change(b),p.change(c),s.change(j),a("#mc4wp-fw-add-to-form").click(k),b()}()}(jQuery);
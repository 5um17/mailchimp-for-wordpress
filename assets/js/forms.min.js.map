{"version":3,"sources":["forms.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","mc4wp","window","listeners","l","document","addEventListener","event","callback","trigger","el","evtName","args","dispatchEvent","CustomEvent","evt","target","className","indexOf","forms","./forms/conditional-elements.js","2","toggleElement","show","getAttribute","conditions","split","fieldName","expectedValues","values","form","inputs","querySelectorAll","input","type","checked","push","value","getFieldValues","element","bubbleElement","parentElement","tagName","findForm","conditionMet","style","display","forEach","required","removeAttribute","setAttribute","evaluate","elements","handleInputEvent"],"mappings":"CAAY,SAASA,EAAEC,EAAEC,EAAEC,GAAG,SAASC,EAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,IAAIE,EAAE,mBAAmBC,SAASA,QAAQ,IAAIF,GAAGC,EAAE,OAAOA,EAAEF,GAAE,GAAI,GAAGI,EAAE,OAAOA,EAAEJ,GAAE,GAAI,IAAIK,EAAE,IAAIC,MAAM,uBAAuBN,EAAE,KAAK,MAAMK,EAAEE,KAAK,mBAAmBF,EAAE,IAAIG,EAAEX,EAAEG,GAAG,CAACS,QAAQ,IAAIb,EAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAoB,OAAOI,EAAlBH,EAAEI,GAAG,GAAGL,IAAeA,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,OAAOD,EAAEG,GAAGS,QAAQ,IAAI,IAAIL,EAAE,mBAAmBD,SAASA,QAAQH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,IAAI,OAAOD,EAA7b,CAA4c,CAACa,EAAE,CAAC,SAAST,EAAQU,EAAOJ,GACxe,aAEA,IAAIK,EAAQC,OAAOD,OAAS,GAE5BX,EAAQ,mCAGR,IAAK,IAAIH,EAAI,EAAGA,EAAIc,EAAME,UAAUL,OAAQX,IAAK,CAC/C,IAAIiB,EAAIH,EAAME,UAAUhB,GACxBkB,SAASC,iBAAiB,SAAWF,EAAEG,MAAOH,EAAEI,UAGlD,SAASC,EAAQC,EAAIC,EAASC,GAC5BF,EAAGG,cAAc,IAAIC,YAAY,SAAWH,EAASC,IAGvDP,SAASC,iBAAiB,SAAU,SAAUS,GAC5C,IAAIL,EAAKK,EAAIC,OAERN,GAAOA,EAAGO,YAAqD,IAAxCP,EAAGO,UAAUC,QAAQ,eAIjDT,EAAQC,EAAI,eAEdT,EAAMkB,MAAQ,CACZV,QAASA,IAGT,CAACW,kCAAkC,IAAIC,EAAE,CAAC,SAAS/B,EAAQU,EAAOJ,GACpE,aAiCA,SAAS0B,EAAcZ,GAUrB,IATA,IAAIa,IAASb,EAAGc,aAAa,gBACzBC,EAAaF,EAAOb,EAAGc,aAAa,gBAAgBE,MAAM,KAAOhB,EAAGc,aAAa,gBAAgBE,MAAM,KACvGC,EAAYF,EAAW,GACvBG,GAAsC,EAApBH,EAAW3B,OAAa2B,EAAW,GAAK,KAAKC,MAAM,KAErEG,EArCN,SAAwBC,EAAMH,GAI5B,IAHA,IAAIE,EAAS,GACTE,EAASD,EAAKE,iBAAiB,eAAiBL,EAAY,mBAAqBA,EAAY,qBAAuBA,EAAY,MAE3HxC,EAAI,EAAGA,EAAI4C,EAAOjC,OAAQX,IAAK,CACtC,IAAI8C,EAAQF,EAAO5C,IAEC,UAAf8C,EAAMC,MAAmC,aAAfD,EAAMC,MAAyBD,EAAME,UAIpEN,EAAOO,KAAKH,EAAMI,OAGpB,OAAOR,EAuBMS,CApBf,SAAkBC,GAGhB,IAFA,IAAIC,EAAgBD,EAEbC,EAAcC,eAGnB,GAA8B,UAF9BD,EAAgBA,EAAcC,eAEZC,QAChB,OAAOF,EAIX,OAAO,KAQIG,CAASjC,GACciB,GAE9BiB,GAAe,EAEVzD,EAAI,EAAGA,EAAI0C,EAAO/B,OAAQX,IAAK,CACtC,IAAIkD,EAAQR,EAAO1C,GAInB,GAFAyD,GAAgD,EAAjChB,EAAeV,QAAQmB,KAA8C,EAA/BT,EAAeV,QAAQ,MAA4B,EAAfmB,EAAMvC,OAG7F,MAMFY,EAAGmC,MAAMC,QADPvB,EACiBqB,EAAe,GAAK,OAEpBA,EAAe,OAAS,GAI7C,IAAIb,EAASrB,EAAGsB,iBAAiB,yBACjC,GAAGe,QAAQlD,KAAKkC,EAAQ,SAAUrB,IAC3BkC,GAAgBrB,IAASb,EAAGc,aAAa,uBAC5Cd,EAAGsC,UAAW,EACdtC,EAAGuC,gBAAgB,sBAGfL,GAAiBrB,IAASb,EAAGsC,WACjCtC,EAAGwC,aAAa,oBAAqB,QACrCxC,EAAGsC,UAAW,KAMpB,SAASG,IACP,IAAIC,EAAW/C,SAAS2B,iBAAiB,yDACzC,GAAGe,QAAQlD,KAAKuD,EAAU9B,GAI5B,SAAS+B,EAAiBtC,GACxB,GAAKA,EAAIC,QAAWD,EAAIC,OAAOc,QAAQf,EAAIC,OAAOc,KAAKb,UAAUC,QAAQ,cAAgB,GAAzF,CAIA,IACIkC,EADOrC,EAAIC,OAAOc,KACFE,iBAAiB,iCACrC,GAAGe,QAAQlD,KAAKuD,EAAU9B,IAG5BjB,SAASC,iBAAiB,QAAS+C,GAAkB,GACrDhD,SAASC,iBAAiB,SAAU+C,GAAkB,GACtDhD,SAASC,iBAAiB,gBAAiB6C,GAAU,GACrDjD,OAAOI,iBAAiB,OAAQ6C,GAChCA,KAEE,KAAK,GAAG,CAAC","file":"forms.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nvar mc4wp = window.mc4wp || {}; // init conditional element logic\n\nrequire('./forms/conditional-elements.js'); // rewrite early-hooked listeners for backwards compatibility\n\n\nfor (var i = 0; i < mc4wp.listeners.length; i++) {\n  var l = mc4wp.listeners[i];\n  document.addEventListener('mc4wp.' + l.event, l.callback);\n}\n\nfunction trigger(el, evtName, args) {\n  el.dispatchEvent(new CustomEvent('mc4wp.' + evtName, args));\n}\n\ndocument.addEventListener('submit', function (evt) {\n  var el = evt.target;\n\n  if (!el || !el.className || el.className.indexOf('mc4wp-form') === -1) {\n    return;\n  }\n\n  trigger(el, 'submitted');\n});\nmc4wp.forms = {\n  trigger: trigger\n};\n\n},{\"./forms/conditional-elements.js\":2}],2:[function(require,module,exports){\n\"use strict\";\n\nfunction getFieldValues(form, fieldName) {\n  var values = [];\n  var inputs = form.querySelectorAll('input[name=\"' + fieldName + '\"],select[name=\"' + fieldName + '\"],textarea[name=\"' + fieldName + '\"]');\n\n  for (var i = 0; i < inputs.length; i++) {\n    var input = inputs[i];\n\n    if ((input.type === 'radio' || input.type === 'checkbox') && !input.checked) {\n      continue;\n    }\n\n    values.push(input.value);\n  }\n\n  return values;\n}\n\nfunction findForm(element) {\n  var bubbleElement = element;\n\n  while (bubbleElement.parentElement) {\n    bubbleElement = bubbleElement.parentElement;\n\n    if (bubbleElement.tagName === 'FORM') {\n      return bubbleElement;\n    }\n  }\n\n  return null;\n}\n\nfunction toggleElement(el) {\n  var show = !!el.getAttribute('data-show-if');\n  var conditions = show ? el.getAttribute('data-show-if').split(':') : el.getAttribute('data-hide-if').split(':');\n  var fieldName = conditions[0];\n  var expectedValues = (conditions.length > 1 ? conditions[1] : '*').split('|');\n  var form = findForm(el);\n  var values = getFieldValues(form, fieldName); // determine whether condition is met\n\n  var conditionMet = false;\n\n  for (var i = 0; i < values.length; i++) {\n    var value = values[i]; // condition is met when value is in array of expected values OR expected values contains a wildcard and value is not empty\n\n    conditionMet = expectedValues.indexOf(value) > -1 || expectedValues.indexOf('*') > -1 && value.length > 0;\n\n    if (conditionMet) {\n      break;\n    }\n  } // toggle element display\n\n\n  if (show) {\n    el.style.display = conditionMet ? '' : 'none';\n  } else {\n    el.style.display = conditionMet ? 'none' : '';\n  } // find all inputs inside this element and toggle [required] attr (to prevent HTML5 validation on hidden elements)\n\n\n  var inputs = el.querySelectorAll('input,select,textarea');\n  [].forEach.call(inputs, function (el) {\n    if ((conditionMet || show) && el.getAttribute('data-was-required')) {\n      el.required = true;\n      el.removeAttribute('data-was-required');\n    }\n\n    if ((!conditionMet || !show) && el.required) {\n      el.setAttribute('data-was-required', 'true');\n      el.required = false;\n    }\n  });\n} // evaluate conditional elements globally\n\n\nfunction evaluate() {\n  var elements = document.querySelectorAll('.mc4wp-form [data-show-if],.mc4wp-form [data-hide-if]');\n  [].forEach.call(elements, toggleElement);\n} // re-evaluate conditional elements for change events on forms\n\n\nfunction handleInputEvent(evt) {\n  if (!evt.target || !evt.target.form || evt.target.form.className.indexOf('mc4wp-form') < 0) {\n    return;\n  }\n\n  var form = evt.target.form;\n  var elements = form.querySelectorAll('[data-show-if],[data-hide-if]');\n  [].forEach.call(elements, toggleElement);\n}\n\ndocument.addEventListener('keyup', handleInputEvent, true);\ndocument.addEventListener('change', handleInputEvent, true);\ndocument.addEventListener('mc4wp-refresh', evaluate, true);\nwindow.addEventListener('load', evaluate);\nevaluate();\n\n},{}]},{},[1]);\n"]}
{"version":3,"sources":["integrations-admin.js"],"names":["r","e","n","t","o","i","f","c","u","a","Error","code","p","exports","call","length","1","require","module","showIfElements","helpers","toggleElement","selector","elements","document","querySelectorAll","show","clientHeight","style","display","bindEventToElement","element","event","handler","addEventListener","attachEvent","bindEventToElements","Array","prototype","forEach","debounce","func","wait","immediate","timeout","context","this","args","arguments","callNow","clearTimeout","setTimeout","apply","config","JSON","parse","getAttribute","parentElements","inputs","hide","undefined","checked","conditionMet","value","visibility","opacity","inputElement","removeAttribute","setAttribute","parentElement","2","_typeof","obj","Symbol","iterator","constructor","listInputs","getElementById","lists","window","mc4wp_vars","mailchimp","selectedLists","listeners","updateSelectedLists","input","push","emit","on","rows","el","searchKey","searchValue","filter","getSelectedListsWhere","replace","getSelectedLists","./helpers.js","3","settings","notice","checkRequiredListFields","allowedFields","ids","map","join","showNotice","fetch","concat","ajaxurl","then","json","list","merge_fields","required","indexOf","tag","./admin/settings.js"],"mappings":"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","file":"integrations-admin.min.js","sourcesContent":["(function () { var require = undefined; var define = undefined; (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nvar helpers = {};\n\nhelpers.toggleElement = function (selector) {\n  var elements = document.querySelectorAll(selector);\n\n  for (var i = 0; i < elements.length; i++) {\n    var show = elements[i].clientHeight <= 0;\n    elements[i].style.display = show ? '' : 'none';\n  }\n};\n\nhelpers.bindEventToElement = function (element, event, handler) {\n  if (element.addEventListener) {\n    element.addEventListener(event, handler);\n  } else if (element.attachEvent) {\n    element.attachEvent('on' + event, handler);\n  }\n};\n\nhelpers.bindEventToElements = function (elements, event, handler) {\n  Array.prototype.forEach.call(elements, function (element) {\n    helpers.bindEventToElement(element, event, handler);\n  });\n}; // polling\n\n\nhelpers.debounce = function (func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this,\n        args = arguments;\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    }, wait);\n    if (callNow) func.apply(context, args);\n  };\n};\n/**\n * Showif.js\n */\n\n\n(function () {\n  var showIfElements = document.querySelectorAll('[data-showif]'); // dependent elements\n\n  Array.prototype.forEach.call(showIfElements, function (element) {\n    var config = JSON.parse(element.getAttribute('data-showif'));\n    var parentElements = document.querySelectorAll('[name=\"' + config.element + '\"]');\n    var inputs = element.querySelectorAll('input,select,textarea:not([readonly])');\n    var hide = config.hide === undefined || config.hide;\n\n    function toggleElement() {\n      // do nothing with unchecked radio inputs\n      if (this.getAttribute('type') === \"radio\" && !this.checked) {\n        return;\n      }\n\n      var value = this.getAttribute(\"type\") === \"checkbox\" ? this.checked : this.value;\n      var conditionMet = value == config.value;\n\n      if (hide) {\n        element.style.display = conditionMet ? '' : 'none';\n        element.style.visibility = conditionMet ? '' : 'hidden';\n      } else {\n        element.style.opacity = conditionMet ? '' : '0.4';\n      } // disable input fields to stop sending their values to server\n\n\n      Array.prototype.forEach.call(inputs, function (inputElement) {\n        conditionMet ? inputElement.removeAttribute('readonly') : inputElement.setAttribute('readonly', 'readonly');\n      });\n    } // find checked element and call toggleElement function\n\n\n    Array.prototype.forEach.call(parentElements, function (parentElement) {\n      toggleElement.call(parentElement);\n    }); // bind on all changes\n\n    helpers.bindEventToElements(parentElements, 'change', toggleElement);\n  });\n})();\n\nmodule.exports = helpers;\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar helpers = require('./helpers.js');\n\nvar context = document.getElementById('mc4wp-admin');\nvar listInputs = context.querySelectorAll('.mc4wp-list-input');\nvar lists = window.mc4wp_vars.mailchimp.lists;\nvar selectedLists = [];\nvar listeners = {}; // functions\n\nfunction getSelectedListsWhere(searchKey, searchValue) {\n  return selectedLists.filter(function (el) {\n    return el[searchKey] === searchValue;\n  });\n}\n\nfunction getSelectedLists() {\n  return selectedLists;\n}\n\nfunction updateSelectedLists() {\n  selectedLists = [];\n  Array.prototype.forEach.call(listInputs, function (input) {\n    // skip unchecked checkboxes\n    if (typeof input.checked === \"boolean\" && !input.checked) {\n      return;\n    }\n\n    if (_typeof(lists[input.value]) === \"object\") {\n      selectedLists.push(lists[input.value]);\n    }\n  });\n  emit('selectedLists.change', [selectedLists]);\n  return selectedLists;\n}\n\nfunction toggleVisibleLists() {\n  var rows = document.querySelectorAll('.lists--only-selected > *');\n  Array.prototype.forEach.call(rows, function (el) {\n    var listId = el.getAttribute('data-list-id');\n    var isSelected = getSelectedListsWhere('id', listId).length > 0;\n\n    if (isSelected) {\n      el.setAttribute('class', el.getAttribute('class').replace('hidden', ''));\n    } else {\n      el.setAttribute('class', el.getAttribute('class') + \" hidden\");\n    }\n  });\n}\n\nfunction emit(event, args) {\n  listeners[event] = listeners[event] || [];\n  listeners[event].forEach(function (f) {\n    return f.apply(null, args);\n  });\n}\n\nfunction on(event, func) {\n  listeners[event] = listeners[event] || [];\n  listeners[event].push(func);\n}\n\non('selectedLists.change', toggleVisibleLists);\nhelpers.bindEventToElements(listInputs, 'change', updateSelectedLists);\nupdateSelectedLists();\nmodule.exports = {\n  getSelectedLists: getSelectedLists,\n  on: on\n};\n\n},{\"./helpers.js\":1}],3:[function(require,module,exports){\n'use strict';\n\nvar settings = require('./admin/settings.js');\n\nvar notice = document.getElementById('notice-additional-fields');\n\nfunction checkRequiredListFields() {\n  var allowedFields = ['EMAIL'];\n  var ids = [].filter.call(document.querySelectorAll('.mc4wp-list-input'), function (i) {\n    return i.checked;\n  }).map(function (i) {\n    return i.value;\n  }).join(','); //const allowedFields = [ 'EMAIL', 'FNAME', 'NAME', 'LNAME' ];\n\n  var showNotice = false;\n  window.fetch(\"\".concat(ajaxurl, \"?action=mc4wp_get_list_details&ids=\").concat(ids)).then(function (r) {\n    return r.json();\n  }).then(function (lists) {\n    lists.forEach(function (list) {\n      list.merge_fields.forEach(function (f) {\n        if (f.required && allowedFields.indexOf(f.tag) < 0) {\n          showNotice = true;\n        }\n      });\n    });\n  })[\"finally\"](function () {\n    notice.style.display = showNotice ? '' : 'none';\n  });\n}\n\nif (notice) {\n  checkRequiredListFields();\n  settings.on('selectedLists.change', checkRequiredListFields);\n}\n\n},{\"./admin/settings.js\":2}]},{},[3]);\n })();"]}
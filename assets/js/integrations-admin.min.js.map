{"version":3,"sources":["integrations-admin.js"],"names":["r","e","n","t","o","i","f","c","u","a","Error","code","p","exports","call","length","1","require","module","_typeof","obj","Symbol","iterator","constructor","prototype","listInputs","document","getElementById","querySelectorAll","lists","window","mc4wp_vars","mailchimp","selectedLists","listeners","updateSelectedLists","Array","forEach","input","checked","value","push","rows","el","searchKey","searchValue","filter","getSelectedListsWhere","getAttribute","setAttribute","replace","toggleVisibleLists","event","args","apply","emit","addEventListener","getSelectedLists","on","func","2","showIfElements","element","config","JSON","parse","parentElements","inputs","hide","undefined","toggleElement","this","conditionMet","style","display","visibility","opacity","inputElement","removeAttribute","3","settings","notice","checkRequiredListFields","allowedFields","ids","map","join","showNotice","fetch","concat","ajaxurl","then","json","list","merge_fields","required","indexOf","tag","./admin/settings.js","./admin/show-if.js"],"mappings":"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","file":"integrations-admin.min.js","sourcesContent":["(function () { var require = undefined; var define = undefined; (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar context = document.getElementById('mc4wp-admin');\nvar listInputs = context.querySelectorAll('.mc4wp-list-input');\nvar lists = window.mc4wp_vars.mailchimp.lists;\nvar selectedLists = [];\nvar listeners = {}; // functions\n\nfunction getSelectedListsWhere(searchKey, searchValue) {\n  return selectedLists.filter(function (el) {\n    return el[searchKey] === searchValue;\n  });\n}\n\nfunction getSelectedLists() {\n  return selectedLists;\n}\n\nfunction updateSelectedLists() {\n  selectedLists = [];\n  Array.prototype.forEach.call(listInputs, function (input) {\n    // skip unchecked checkboxes\n    if (typeof input.checked === \"boolean\" && !input.checked) {\n      return;\n    }\n\n    if (_typeof(lists[input.value]) === \"object\") {\n      selectedLists.push(lists[input.value]);\n    }\n  });\n  toggleVisibleLists();\n  emit('selectedLists.change', [selectedLists]);\n  return selectedLists;\n}\n\nfunction toggleVisibleLists() {\n  var rows = document.querySelectorAll('.lists--only-selected > *');\n  Array.prototype.forEach.call(rows, function (el) {\n    var listId = el.getAttribute('data-list-id');\n    var isSelected = getSelectedListsWhere('id', listId).length > 0;\n\n    if (isSelected) {\n      el.setAttribute('class', el.getAttribute('class').replace('hidden', ''));\n    } else {\n      el.setAttribute('class', el.getAttribute('class') + \" hidden\");\n    }\n  });\n}\n\nfunction emit(event, args) {\n  listeners[event] = listeners[event] || [];\n  listeners[event].forEach(function (f) {\n    return f.apply(null, args);\n  });\n}\n\nfunction on(event, func) {\n  listeners[event] = listeners[event] || [];\n  listeners[event].push(func);\n}\n\n[].forEach.call(listInputs, function (el) {\n  el.addEventListener('change', updateSelectedLists);\n});\nupdateSelectedLists();\nmodule.exports = {\n  getSelectedLists: getSelectedLists,\n  on: on\n};\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nvar showIfElements = document.querySelectorAll('[data-showif]');\n[].forEach.call(showIfElements, function (element) {\n  var config = JSON.parse(element.getAttribute('data-showif'));\n  var parentElements = document.querySelectorAll('[name=\"' + config.element + '\"]');\n  var inputs = element.querySelectorAll('input,select,textarea:not([readonly])');\n  var hide = config.hide === undefined || config.hide;\n\n  function toggleElement() {\n    // do nothing with unchecked radio inputs\n    if (this.getAttribute('type') === \"radio\" && !this.checked) {\n      return;\n    }\n\n    var value = this.getAttribute(\"type\") === \"checkbox\" ? this.checked : this.value;\n    var conditionMet = value == config.value;\n\n    if (hide) {\n      element.style.display = conditionMet ? '' : 'none';\n      element.style.visibility = conditionMet ? '' : 'hidden';\n    } else {\n      element.style.opacity = conditionMet ? '' : '0.4';\n    } // disable input fields to stop sending their values to server\n\n\n    [].forEach.call(inputs, function (inputElement) {\n      conditionMet ? inputElement.removeAttribute('readonly') : inputElement.setAttribute('readonly', 'readonly');\n    });\n  } // find checked element and call toggleElement function\n\n\n  [].forEach.call(parentElements, function (el) {\n    el.addEventListener('change', toggleElement);\n    toggleElement.call(el);\n  });\n});\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nvar settings = require('./admin/settings.js');\n\nvar notice = document.getElementById('notice-additional-fields');\n\nrequire('./admin/show-if.js');\n\nfunction checkRequiredListFields() {\n  var allowedFields = ['EMAIL'];\n  var ids = [].filter.call(document.querySelectorAll('.mc4wp-list-input'), function (i) {\n    return i.checked;\n  }).map(function (i) {\n    return i.value;\n  }).join(','); //const allowedFields = [ 'EMAIL', 'FNAME', 'NAME', 'LNAME' ];\n\n  var showNotice = false;\n  window.fetch(\"\".concat(ajaxurl, \"?action=mc4wp_get_list_details&ids=\").concat(ids)).then(function (r) {\n    return r.json();\n  }).then(function (lists) {\n    lists.forEach(function (list) {\n      list.merge_fields.forEach(function (f) {\n        if (f.required && allowedFields.indexOf(f.tag) < 0) {\n          showNotice = true;\n        }\n      });\n    });\n  })[\"finally\"](function () {\n    notice.style.display = showNotice ? '' : 'none';\n  });\n}\n\nif (notice) {\n  checkRequiredListFields();\n  settings.on('selectedLists.change', checkRequiredListFields);\n}\n\n},{\"./admin/settings.js\":1,\"./admin/show-if.js\":2}]},{},[3]);\n })();"]}